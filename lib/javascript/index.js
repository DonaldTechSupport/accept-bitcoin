// Generated by CoffeeScript 1.6.3
var Key, Main, Transaction, bitcore, ee, extend, fs, http;

http = require('http');

bitcore = require('bitcore');

Key = require('./key');

Transaction = require('./transaction');

fs = require('fs');

ee = require('events').EventEmitter;

Main = (function() {
  var settings;

  settings = {
    network: bitcore.networks.livenet,
    password: 'enter_your_password_here',
    storePath: './keys.json',
    encryptPrivateKey: false,
    payToAddress: 'nulssdl',
    checkTransactionEvery: 1000,
    checkTransactionMaxAttempts: 10,
    minimumConfirmations: 6
  };

  function Main(address, o) {
    var tx,
      _this = this;
    if (o == null) {
      o = {};
    }
    if (!address) {
      return 'must have address';
    }
    ee.call(this);
    console.log('hello ' + address);
    this.settings = extend(settings, o);
    tx = new Transaction(this.settings);
    tx.checkBalance('14nsgXjL7xCEXFf8UkGCm9KnSTTFBDKqcn', function(err, d) {
      console.log(err, d);
      return _this.emit('foo', 'found!');
    });
  }

  Main.prototype.generateKey = function() {
    var key;
    key = new Key(settings);
    return key.address();
  };

  Main.prototype.paymentRequest = function(params, cb) {
    var key;
    key = this.generateKey();
    return cb(null, settings.payToAddress);
  };

  return Main;

})();

extend = function(object, properties) {
  var key, val;
  for (key in properties) {
    val = properties[key];
    object[key] = val;
  }
  return object;
};

Main.prototype.__proto__ = ee.prototype;

module.exports = Main;
